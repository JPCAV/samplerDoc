<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Troubleshooting PMwG errors | Particle Based Samplers for MCMC</title>
  <meta name="description" content="Particle Based Sampler for MCMC" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Troubleshooting PMwG errors | Particle Based Samplers for MCMC" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Particle Based Sampler for MCMC" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Troubleshooting PMwG errors | Particle Based Samplers for MCMC" />
  
  <meta name="twitter:description" content="Particle Based Sampler for MCMC" />
  

<meta name="author" content="Jon-Paul Cavallaro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PMwG Samplers Package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Particle Based Sampler for MCMC</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#computational-requirements"><i class="fa fa-check"></i><b>1.1</b> Computational Requirements</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#assumed-knowledge"><i class="fa fa-check"></i><b>1.2</b> Assumed knowledge</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-would-you-use-particle-metropolis-within-gibbs-sampling"><i class="fa fa-check"></i><b>1.3</b> Why would you use Particle Metropolis within Gibbs Sampling</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#the-hierarchical-structure-assumed"><i class="fa fa-check"></i><b>1.4</b> The Hierarchical Structure Assumed</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-particle-metropolis-within-gibbs-sampling-provides"><i class="fa fa-check"></i><b>1.5</b> What Particle Metropolis within Gibbs Sampling provides</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#what-is-particle-metropolis-within-gibbs-sampling"><i class="fa fa-check"></i><b>1.6</b> What is Particle Metropolis within Gibbs Sampling?</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#how-do-we-generate-proposals-in-pmwg-sampling-using-particle-metropolis"><i class="fa fa-check"></i><b>1.7</b> How do we generate proposals in PMwG sampling using Particle Metropolis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html"><i class="fa fa-check"></i><b>2</b> PMwG sampler and Signal Detection Theory</a><ul>
<li class="chapter" data-level="2.0.1" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#sdtOutline"><i class="fa fa-check"></i><b>2.0.1</b> Signal Detection Theory analysis of lexical decision task</a></li>
<li class="chapter" data-level="2.0.2" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#writing-a-log-likelihood-function"><i class="fa fa-check"></i><b>2.0.2</b> Writing a log-likelihood function</a></li>
<li class="chapter" data-level="2.1" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#testing-the-sdt-log-likelihood-function"><i class="fa fa-check"></i><b>2.1</b> Testing the SDT log-likelihood function</a></li>
<li class="chapter" data-level="2.2" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#sdt-log-likelihood-function-for-wagenmakers-experiment"><i class="fa fa-check"></i><b>2.2</b> SDT log-likelihood function for Wagenmakers experiment</a><ul>
<li class="chapter" data-level="2.2.1" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#description-of-wagenmakers-experiment"><i class="fa fa-check"></i><b>2.2.1</b> Description of Wagenmakers experiment</a></li>
<li class="chapter" data-level="2.2.2" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#computation-time-of-log-likelihood-function"><i class="fa fa-check"></i><b>2.2.2</b> Computation time of log-likelihood function</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#sdtPMwG"><i class="fa fa-check"></i><b>2.3</b> PMwG Framework</a><ul>
<li class="chapter" data-level="2.3.1" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#start-points"><i class="fa fa-check"></i><b>2.3.1</b> Model start points</a></li>
<li class="chapter" data-level="2.3.2" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#run-sdtsampler"><i class="fa fa-check"></i><b>2.3.2</b> Running the sampler</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#check-sampling-process"><i class="fa fa-check"></i><b>2.4</b> Check sampling process</a></li>
<li class="chapter" data-level="2.5" data-path="pmwg-sampler-and-signal-detection-theory.html"><a href="pmwg-sampler-and-signal-detection-theory.html#simulating-posterior-data"><i class="fa fa-check"></i><b>2.5</b> Simulating posterior data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="forstmannChapter.html"><a href="forstmannChapter.html"><i class="fa fa-check"></i><b>3</b> PMwG sampler and sequential sampling models</a><ul>
<li class="chapter" data-level="3.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#the-speed-accuracy-tradeoff-in-perceptual-decisions"><i class="fa fa-check"></i><b>3.1</b> The speed-accuracy tradeoff in perceptual decisions</a></li>
<li class="chapter" data-level="3.2" data-path="forstmannChapter.html"><a href="forstmannChapter.html#linear-ballistic-accumulator-parameters"><i class="fa fa-check"></i><b>3.2</b> Linear Ballistic Accumulator Parameters</a></li>
<li class="chapter" data-level="3.3" data-path="forstmannChapter.html"><a href="forstmannChapter.html#writellFunc"><i class="fa fa-check"></i><b>3.3</b> Writing the log-likelihood function</a><ul>
<li class="chapter" data-level="3.3.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#fstLBALL"><i class="fa fa-check"></i><b>3.3.1</b> Fast LBA Log-likelihood Function</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="forstmannChapter.html"><a href="forstmannChapter.html#pmwg-framework"><i class="fa fa-check"></i><b>3.4</b> PMwG Framework</a><ul>
<li class="chapter" data-level="3.4.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#lbaStartPts"><i class="fa fa-check"></i><b>3.4.1</b> Model start points</a></li>
<li class="chapter" data-level="3.4.2" data-path="forstmannChapter.html"><a href="forstmannChapter.html#run-sampler"><i class="fa fa-check"></i><b>3.4.2</b> Running the sampler</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="forstmannChapter.html"><a href="forstmannChapter.html#genppdatafunc"><i class="fa fa-check"></i><b>3.5</b> Simulating Posterior Predictive Data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#assessing-descriptive-adequacy-goodness-of-fit"><i class="fa fa-check"></i><b>3.5.1</b> Assessing Descriptive Adequacy (goodness of fit)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="forstmannChapter.html"><a href="forstmannChapter.html#evaluating-different-models---single-threshold-lba"><i class="fa fa-check"></i><b>3.6</b> Evaluating different models - single threshold LBA</a><ul>
<li class="chapter" data-level="3.6.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#pmwg-framework-for-a-single-threshold-model"><i class="fa fa-check"></i><b>3.6.1</b> PMwG framework for a single threshold model</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="forstmannChapter.html"><a href="forstmannChapter.html#checking-descriptive-adequacy-of-1b-model."><i class="fa fa-check"></i><b>3.7</b> Checking Descriptive Adequacy of 1b model.</a></li>
<li class="chapter" data-level="3.8" data-path="forstmannChapter.html"><a href="forstmannChapter.html#model-comparison"><i class="fa fa-check"></i><b>3.8</b> Model Comparison</a><ul>
<li class="chapter" data-level="3.8.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#assessing-descriptive-adequacy-graphically"><i class="fa fa-check"></i><b>3.8.1</b> Assessing Descriptive Adequacy Graphically</a></li>
<li class="chapter" data-level="3.8.2" data-path="forstmannChapter.html"><a href="forstmannChapter.html#model-comparison-via-dic"><i class="fa fa-check"></i><b>3.8.2</b> Model comparison via DIC</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="forstmannChapter.html"><a href="forstmannChapter.html#checking-the-lba-log-likelihood-function"><i class="fa fa-check"></i><b>3.9</b> Checking the LBA log-likelihood function</a><ul>
<li class="chapter" data-level="3.9.1" data-path="forstmannChapter.html"><a href="forstmannChapter.html#test-one-do-changes-in-parameter-values-cause-changes-in-the-returned-log-likelihood"><i class="fa fa-check"></i><b>3.9.1</b> Test one: Do changes in parameter values cause changes in the returned log-likelihood?</a></li>
<li class="chapter" data-level="3.9.2" data-path="forstmannChapter.html"><a href="forstmannChapter.html#testing-whether-true-x-values-have-the-highest-likelihood"><i class="fa fa-check"></i><b>3.9.2</b> Testing whether true-x values have the highest likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html"><a href="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html"><i class="fa fa-check"></i><b>4</b> PMwG sampler with the Linear Ballistic Accumulator and a complex experiment design</a><ul>
<li class="chapter" data-level="4.1" data-path="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html"><a href="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html#writing-the-lba-log-likelihood-function-for-the-wagenmakers-data-set"><i class="fa fa-check"></i><b>4.1</b> Writing the LBA log-likelihood function for the Wagenmakers data set</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="troubleshoot.html"><a href="troubleshoot.html"><i class="fa fa-check"></i><b>5</b> Troubleshooting PMwG errors</a><ul>
<li class="chapter" data-level="5.1" data-path="troubleshoot.html"><a href="troubleshoot.html#how-to-write-a-log-likelihood-function"><i class="fa fa-check"></i><b>5.1</b> How to write a log-likelihood function</a><ul>
<li class="chapter" data-level="5.1.1" data-path="troubleshoot.html"><a href="troubleshoot.html#writing-your-log-likelihood-function-tips-errors-and-check-list"><i class="fa fa-check"></i><b>5.1.1</b> Writing your log-likelihood function: Tips, errors and check list</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="troubleshoot.html"><a href="troubleshoot.html#appendix"><i class="fa fa-check"></i><b>5.2</b> Appendix</a><ul>
<li class="chapter" data-level="5.2.1" data-path="troubleshoot.html"><a href="troubleshoot.html#wagSDTscript"><i class="fa fa-check"></i><b>5.2.1</b> Wagenmakers SDT script</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://newcastlecl.org/" target="blank">Published by Newcastle Cognition Lab</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Particle Based Samplers for MCMC</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="troubleshoot" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Troubleshooting PMwG errors</h1>
<div id="how-to-write-a-log-likelihood-function" class="section level2">
<h2><span class="header-section-number">5.1</span> How to write a log-likelihood function</h2>
<ul>
<li>What key elements are required in a log-likelihood function to be used in the sampler</li>
<li>Show comparison times for slow LL and fast LL</li>
<li>Check list for commmon errors - brief list check this, check that etc.</li>
</ul>
<div id="writing-your-log-likelihood-function-tips-errors-and-check-list" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Writing your log-likelihood function: Tips, errors and check list</h3>
<p><b>1. The parameter specified does not exist</b></p>
<p>The parameter name is not specified to be estimated i.e. it is not in the parameter names argument or it is misspelled. Make sure <code>pars</code> vector contains the same parameter names you have included in your log-likelihood function and it is the same length. Do not rely on the log likelihood function to throw an error in this case. (e.g.<code>x[‘b’]</code>)</p>
<p><b>2. All non-continuous data frame variables must be a</b> <code>factor</code>.</p>
<p>Data frame variables should be <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/factor"><code>factors</code></a> unless the variable is a continuous variable e.g. response time. If you pass <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/character"><code>character</code></a> variables to <code>if</code> statements and/or <code>for</code> loops in your log likelihood function, errors will not occur, however, your log likelihood estimate will be incorrect. For example, avoid using character strings like <code>data$condition == “easy”</code>. If you must use a character string, be sure to convert the string to a factor with <code>as.factor</code>.</p>
<p><b>3. Spelling errors or mismatched column name references</b></p>
<p>Correctly reference data frame column names in your log likelihood function e.g. <code>data$RT</code> != <code>data$rt</code>.</p>
<p><b>4. When initialising a vector of parameter values - values are not filling in properly</b></p>
<p>E.g. When a vector for b for all the values across the data set to be used, but there are NAs filling it somewhere.</p>
<p><b>5. Make sure operations are done on the right scale.</b></p>
<p><b>6. Data frame variables are scaled appropriately for the model</b></p>
<p>Check your variables are correctly scaled and in the correct units. For example, with the LBA, response times must be in seconds rather than milliseconds.</p>
<p><b>7. The log-likelihood is printed/outputted at the end of function</b></p>
<p>Make sure your log-likelihood function prints an estimate at the end of the function and the estimate is correctly obtained e.g. sum the log-likelihood estimates for all trials/rows.</p>
<p><b>8. Sampling error occurs</b></p>
<p>When sampling, the generated columns are not outputted</p>
<p><b>9. When executing functions row by row (i.e. trial-wise), index MUST be included</b></p>
<p>If writing a trial-wise/row-wise function (e.g. <code>if</code> statement, <code>for</code> loop), index <code>i</code> must be specified.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (data<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>“easy”)     <span class="co"># Incorrect reference when iterating over variable</span>
<span class="cf">if</span> (data<span class="op">$</span>condition[i] <span class="op">==</span><span class="st"> </span>“easy”)  <span class="co"># Include i index</span></code></pre></div>
<p><b>10. Changing parameter values changes the log-likelihood estimate</b></p>
<p>A simple check to run on your log-likelihood function is to modify your parameter values and observe the change to log-likelihood estimate. Then check if changing parameter values which rely on conditions actually change the log-likelihood estimate.</p>
<p><b>11. Make sure you have the latest version of the PMwG Samplers package</b></p>
<p>checkVersion(“pmwg”)</p>
<p><b>12. Number of iterations for ’burn-in` stage of sampler.</b></p>
<p>We suggest running <code>burn-in</code> for few iterations and particles first. This will give you a sense of a) whether the sampler is working as intended (see troubleshooting/checks for what parameter chains should look like), b) the number of iterations &amp; particles needed to achieve the target acceptance rate, as well as the appropriate epsilon value. The acceptance rate is generally very high for the first few iterations ( &gt; 100) and then declines. After the initial short run, you can check and optimise the number of particles to be used (and balance with epsilon), so the acceptance rate is close to 30% on a longer, full run. We recommend you start with epsilon = .5 to increase efficiency, then adjust as needed.</p>
<p><b>NOTE:</b> Overall, we aim for ~30% acceptance rate of particles. High acceptance rates may be inaccurate if burn-in runs for few iterations. Low acceptance rates are inefficient and may fail to create an efficient distribution for the sampling stage.</p>
</div>
</div>
<div id="appendix" class="section level2">
<h2><span class="header-section-number">5.2</span> Appendix</h2>
<div id="wagSDTscript" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Wagenmakers SDT script</h3>
<p>A zipped folder containing the dataset from <span class="citation">Wagenmakers et al. (<a href="#ref-wagenmakers2008diffusion">2008</a>)</span> can be found at this <a href="https://www.ejwagenmakers.com/Code/2008/LexDecData.zip">link</a>. As shown in our script below, the data is stored in the <code>&quot;PropData.txt&quot;</code> file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#~~~~~~~~~~~~~~~~~~~~ Wagenmakers 2008 Lexical decision task ~~~~~~~~~~~~~~~~~~~~~~~~~~~#</span>

<span class="co"># 1) subject = participant number</span>
<span class="co"># 2) block = block number</span>
<span class="co"># 3) practice = 1 if practice block, otherwise 0</span>
<span class="co"># 4) cond = condition either &quot;2&quot; for 75% words or &quot;1&quot; for 75% nonwords)</span>
<span class="co"># 5) stimulus = unique identifier of stimulus, stimuli are nested in frequency conditions</span>
<span class="co"># 6) freq = Code &quot;1&quot; means &quot;high frequency word&quot;, code &quot;2&quot; means &quot;low frequency word&quot;,</span>
<span class="co">#    and code &quot;3&quot; means &quot;very low frequency word&quot;. Codes 4, 5, and 6 = &quot;nonword&quot;.</span>
<span class="co"># 7) resp =  0 is nonword, 1 is word, -1 is not interpretable response (i.e., pushed a button,</span>
<span class="co">#         but not the right one and also not the one next to the right button)</span>
<span class="co"># 8) rt = response time in seconds</span>
<span class="co"># 9) censor = 1 if value is eliminated from further analysis;</span>
<span class="co">#       practice block, uninterpretable response, too fast response (&lt;180 ms), too slow response (&gt;3 sec)</span>

<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="kw">require</span>(tidyverse)

wagenmakers2008 &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;PropData.txt&quot;</span>,
                              <span class="dt">header =</span> <span class="ot">FALSE</span>)

<span class="kw">names</span>(wagenmakers2008) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;block&quot;</span>,<span class="st">&quot;practice&quot;</span>,<span class="st">&quot;cond&quot;</span>,<span class="st">&quot;stimulus&quot;</span>,<span class="st">&quot;freq&quot;</span>,<span class="st">&quot;resp&quot;</span>,<span class="st">&quot;rt&quot;</span>,<span class="st">&quot;censor&quot;</span>)

wagenmakers2008 &lt;-<span class="st"> </span>wagenmakers2008[wagenmakers2008<span class="op">$</span>censor<span class="op">!=</span><span class="dv">1</span>,<span class="op">-</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">9</span>)]

wagenmakers2008<span class="op">$</span>subject &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>subject)

wagenmakers2008<span class="op">$</span>cond &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>cond,
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;nw&quot;</span>,<span class="st">&quot;w&quot;</span>))

wagenmakers2008<span class="op">$</span>stimulus &lt;-<span class="st"> </span>wagenmakers2008<span class="op">$</span>freq <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>

wagenmakers2008<span class="op">$</span>stimulus &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>stimulus,
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;nw&quot;</span>, <span class="st">&quot;w&quot;</span>))

wagenmakers2008<span class="op">$</span>resp &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>resp,
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;NW&quot;</span>,<span class="st">&quot;W&quot;</span>))

wagenmakers2008<span class="op">$</span>freq &lt;-<span class="st"> </span>((wagenmakers2008<span class="op">$</span>freq<span class="op">-</span><span class="dv">1</span>) <span class="op">%%</span><span class="st"> </span><span class="dv">3</span>)<span class="op">+</span><span class="dv">1</span>

wagenmakers2008<span class="op">$</span>freq &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>freq,
                  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hf&quot;</span>,<span class="st">&quot;lf&quot;</span>,<span class="st">&quot;vlf&quot;</span>))

wagenmakers2008<span class="op">$</span>correct &lt;-<span class="st"> </span><span class="kw">toupper</span>(wagenmakers2008<span class="op">$</span>stimulus) <span class="op">==</span><span class="st"> </span><span class="kw">toupper</span>(wagenmakers2008<span class="op">$</span>resp)

wagenmakers2008<span class="op">$</span>W &lt;-<span class="st"> </span><span class="kw">as.character</span>(wagenmakers2008<span class="op">$</span>freq)

wagenmakers2008<span class="op">$</span>W[wagenmakers2008<span class="op">$</span>stimulus <span class="op">==</span><span class="st">&quot;nw&quot;</span>] &lt;-<span class="st"> &quot;nw&quot;</span>

wagenmakers2008<span class="op">$</span>W &lt;-<span class="st"> </span><span class="kw">factor</span>(wagenmakers2008<span class="op">$</span>W,
                  <span class="kw">c</span>(<span class="st">&quot;hf&quot;</span>,<span class="st">&quot;lf&quot;</span>,<span class="st">&quot;vlf&quot;</span>,<span class="st">&quot;nw&quot;</span>))

wagenmakers2008 &lt;-<span class="st"> </span><span class="kw">select</span>(<span class="dt">.data =</span> wagenmakers2008, subject, cond, W, resp, rt, correct) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">stimulus =</span> W)

wagenmakers2008<span class="op">$</span>correct &lt;-<span class="st"> </span><span class="kw">if_else</span>(wagenmakers2008<span class="op">$</span>correct,
                                   <span class="dt">true =</span> <span class="st">&quot;2&quot;</span>,
                                   <span class="dt">false =</span> <span class="st">&quot;1&quot;</span>)
<span class="kw">save</span>(wagenmakers2008,
     <span class="dt">file =</span> <span class="st">&quot;wagenmakers2008.RData&quot;</span>)</code></pre></div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wagenmakers2008diffusion">
<p>Wagenmakers, Eric-Jan, Roger Ratcliff, Pablo Gomez, and Gail McKoon. 2008. “A Diffusion Model Account of Criterion Shifts in the Lexical Decision Task.” <em>Journal of Memory and Language</em> 58 (1). Elsevier: 140–59.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pmwg-sampler-with-the-linear-ballistic-accumulator-and-a-complex-experiment-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-troubleshoot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
